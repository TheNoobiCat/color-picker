/*! Color-Picker 0.9.3 MIT | https://github.com/yairEO/color-picker */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).ColorPicker=e()}(this,(function(){"use strict";var t=t=>(new DOMParser).parseFromString(t.trim(),"text/html").body.firstElementChild,e={color:"white",onInput:t=>t,onChange:t=>t};const s=t=>t.match(/\((.*)\)/)[1].split(",").map(Number),i=t=>`hsla(${t.h}, ${t.s}%, ${t.l}%, ${t.a}%)`,a=t=>t.toFixed(1).replace(".0",""),o=t=>{const[e,s,i,a]=(t=>t.match(/\w\w/g))(t),[o,n,h]=[e,s,i].map((t=>parseInt(t,16)));return`rgba(${o},${n},${h},${a?(parseInt(a,16)/255).toFixed(2):1})`},n=t=>{var e,s=document.createElement("canvas").getContext("2d");return s.fillStyle=t,"#"==(e=s.fillStyle)[0]?e:h(e)},h=t=>{const[e,i,a,o]=s(t),n="#"+[e,i,a].map((t=>t.toString(16).padStart(2,"0"))).join("");return 3==t.length?n:n+Math.round(255*o).toString(16).padStart(2,"0")},r=t=>{let[e,i,o,n]=s(t);e/=255,i/=255,o/=255;let h=Math.max(e,i,o),r=Math.min(e,i,o),l=h-r,c=0,u=0,d=((h+r)/2).toPrecision(5);return l&&(u=d>.5?l/(2-h-r):l/(h+r),c=h==e?(i-o)/l+(i<o?6:0):c=h==i?(o-e)/l+2:(e-i)/l+4,c/=6),{h:a(360*c),s:a(100*u),l:a(100*d),a:a(100*n)}};function l({name:t,min:e=0,max:s=100,value:i}){return`<div class="range color-picker__${t}" title="${t}" style="--min:${e}; --max:${s};">\n            <input type="range" name="${t}" value="${i}" min="${e}" max="${s}">\n            <output></output>\n            <div class='range__progress'></div>\n          </div>`}function c(t){return`\n    <div class='color-picker__value cp-checkboard'>\n      <input name='value' placeholder='CSS Color' value='${n(i(t))}'>\n      <button title='Undo' name="undo">↩</button>\n      <button title='Switch color format' name='format'>⭤&nbsp;</button>\n      <div></div>\n    </div>\n  `}function u(t,e){return`\n    <div class='color-picker__swatches' style='--initial-len:${e.length}'>\n      <button name='addSwatch' title='Add to Swatches'>+</button>\n      ${t.map((t=>d(t,e.includes(t)))).join("")}\n    </div>\n  `}function d(t,e){return`<div class="cp-checkboard color-picker__swatch" title="${t}" style="--c:${t}">${e?"":'<button name="removeSwatch">&times;</button>'}</div>`}var p=Object.freeze({__proto__:null,scope:function(){const{h:t,s:e,l:s,a:i}=this.color;return`\n    <div class='${("color-picker "+(this.settings.className||"")).trim()}'>\n      ${l({name:"hue",value:t,max:"360"})}\n      ${l({name:"saturation",value:e})}\n      ${l({name:"lightness",value:s})}\n      ${l({name:"alpha",value:i})}\n      <output></output>\n      ${c(this.color)}\n      ${this.swatches?u(this.swatches,this.initialSwatches):""}\n    </div>\n  `},slider:l,value:c,swatches:u,swatch:d});function S(){this.syncGlobalSwatchesWithLocal()}function m(t){const{value:e,max:s}=t.target,i=-1*Math.sign(t.deltaY);this.DOM.scope.contains(t.target)&&(t.target.value=Math.min(Math.max(+e+i,0),+s),w.call(this,t))}function g(t){"Escape"==t.key&&this.settings.onClickOutside(t)}function v(t){this.DOM.scope.contains(t.target)||this.settings.onClickOutside(t)}function w(t){const{name:e,value:s,type:i}=t.target;"range"==i&&this.setColor({...this.color,[e[0]]:+s})}function f(t){const{type:e}=t.target;"range"!=e&&"text"!=e||(this.history.last=this.color)}function b(t){this.setColor(this.getHSLA(t.target.value)),this.DOM.value.blur()}function C(t){const{name:e,parentNode:s,classList:i,title:a}=t.target;"format"==e?this.swithFormat():"undo"==e?this.history.undo():"addSwatch"==e?this.addSwatch():"removeSwatch"==e?this.removeSwatch(s,s.title):i.contains("color-picker__swatch")&&a&&(this.history.last=this.color,this.setColor(this.getHSLA(a)))}var _=Object.freeze({__proto__:null,bindEvents:function(){[["scope","input",w],["scope","change",f],["scope","click",C],["value","change",b]].forEach((([t,e,s])=>this.DOM[t].addEventListener(e,s.bind(this)))),window.addEventListener("wheel",m.bind(this)),window.addEventListener("storage",S.bind(this)),this.settings.onClickOutside&&(document.body.addEventListener("click",v.bind(this)),window.addEventListener("keydown",g.bind(this)))}});function O(){const t=()=>this.settings.onChange(this.CSSColor),e=this.setColor.bind(this);return{_value:[this.color],get pop(){return this._value.pop()},get previous(){return this._value[this._value.length-2]},set last(e){this._value.push(e),t()},undo(){if(this._value.length>1){this.pop;let s=this._value[this._value.length-1];return e(s),t(),s}}}}const y="@yaireo/color-picker/swatches";var M=Object.freeze({__proto__:null,getSetGlobalSwatches:function(t){const e=this.settings.swatchesLocalStorage,s="string"==typeof e?e:"";return e&&t&&(localStorage.setItem(y+s,t),dispatchEvent(new Event("storage"))),localStorage[y+s]?.split(",").filter(String)||[]},syncGlobalSwatchesWithLocal:function(){this.sharedSwatches=this.getSetGlobalSwatches(),this.swatches=this.sharedSwatches.concat(this.initialSwatches),this.DOM.swatches&&setTimeout((()=>{const e=t(this.templates.swatches.call(this,this.swatches,this.initialSwatches));this.DOM.swatches.replaceWith(e),this.DOM.swatches=e}),500)},addSwatch:function(e=this.CSSColor){if(((t,e)=>t.some((t=>(console.log(n(t),n(e),n(t)==n(e)),n(t)==n(e)))))(this.swatches,e))return;const s=t(this.templates.swatch(e));s.classList.add("cp_remove"),this.DOM.swatches.prepend(s),setTimeout((()=>s.classList.remove("cp_remove")),0),this.swatches.unshift(e),this.sharedSwatches.unshift(e),this.getSetGlobalSwatches(this.sharedSwatches)},removeSwatch:function(t,e){t.classList.add("cp_remove"),setTimeout((()=>t.remove()),200);const s=t=>t!=e;this.swatches=this.swatches.filter(s),this.sharedSwatches=this.sharedSwatches.filter(s),this.getSetGlobalSwatches(this.sharedSwatches)}});function $(t){this.settings=Object.assign({},e,t);const{color:s,defaultFormat:i,swatches:a}=this.settings;this.DOM={},this.sharedSwatches=this.getSetGlobalSwatches(),this.initialSwatches=a||[],this.swatches=a&&this.sharedSwatches.concat(this.initialSwatches),this.setColor(this.getHSLA(this.changeColorFormat(s,i))),this.history=O.call(this),this.init()}return $.prototype={templates:p,...M,..._,getColorFormat:t=>"#"==t[0]?"hex":t.indexOf("hsl")?t.indexOf("rgb")?"":"rgba":"hsla",changeColorFormat:(t,e)=>(e=(e+"").toLowerCase(),t=n(t),"hex"==e?t:e.startsWith("hsl")?i(r(o(t))):e.startsWith("rgb")?o(t):t),getHSLA(t){let e;var s;return this.colorFormat=this.getColorFormat(t),t.indexOf("hsla")?(t=n(t),t=o(t),e=r(t)):(s=t,e=Object.assign([0,0,0,1],s.match(/\((.*)\)/)[1].split(",").map(((t,e)=>3!=e||t.includes("%")?parseFloat(t):100*parseFloat(t)))),e={h:e[0],s:e[1],l:e[2],a:e[3]}),e},swithFormat(){switch(this.colorFormat){case"":case"hex":this.colorFormat="rgba";break;case"rgba":this.colorFormat="hsla";break;case"hsla":this.colorFormat="hex"}this.setCSSColor(),this.DOM.value.value=this.CSSColor},updateRangeSlider(t,e){const s=this.DOM.scope.querySelector(`input[name="${t}"]`);s&&(s.value=e,s.parentNode.style.setProperty("--value",e),s.parentNode.style.setProperty("--text-value",JSON.stringify(""+Math.round(e))),this.updateCSSVar(t,e))},setCSSColor(){this.CSSColor=n(i(this.color)),"rgba"==this.colorFormat?this.CSSColor=o(this.CSSColor):"hsla"==this.colorFormat&&(this.CSSColor=i(this.color)),this.DOM.scope&&this.DOM.scope.setAttribute("data-color-format",this.colorFormat),this.settings.onInput(this.CSSColor)},setColor(t){t&&(this.color=t,this.setCSSColor(),this.DOM.scope&&this.updateAllCSSVars(),this.DOM.value&&(this.DOM.value.value=this.CSSColor))},updateCSSVar(t,e){this.DOM.scope.style.setProperty("--"+t,e)},updateAllCSSVars(){const t=this.NamedHSLA(this.color);Object.entries(t).forEach((([t,e])=>{this.updateRangeSlider(t,e)}))},NamedHSLA:t=>({hue:t.h,saturation:t.s,lightness:t.l,alpha:t.a}),build(){const e=this.templates.scope.call(this);this.DOM.scope=t(e),this.DOM.value=this.DOM.scope.querySelector('input[name="value"]'),this.DOM.swatches=this.DOM.scope.querySelector(".color-picker__swatches")},init(){this.build(),this.setColor(this.color),this.bindEvents()}},$}));
