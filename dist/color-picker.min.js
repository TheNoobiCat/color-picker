/*! Color-Picker 0.9.0 MIT | https://github.com/yairEO/color-picker */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).ColorPicker=e()}(this,(function(){"use strict";var t={color:"white",onInput:t=>t,onChange:t=>t};const e=t=>t.match(/\((.*)\)/)[1].split(",").map(Number),s=t=>`hsla(${t.h}, ${t.s}%, ${t.l}%, ${t.a}%)`,o=t=>t.toFixed(1).replace(".0",""),i=t=>{const[e,s,o,i]=(t=>t.match(/\w\w/g))(t),[n,a,r]=[e,s,o].map((t=>parseInt(t,16)));return`rgba(${n},${a},${r},${i?(parseInt(i,16)/255).toFixed(2):1})`},n=t=>{var e,s=document.createElement("canvas").getContext("2d");return s.fillStyle=t,"#"==(e=s.fillStyle)[0]?e:a(e)},a=t=>{const[s,o,i,n]=e(t),a="#"+[s,o,i].map((t=>t.toString(16).padStart(2,"0"))).join("");return 3==t.length?a:a+Math.round(255*n).toString(16).padStart(2,"0")};function r({name:t,min:e=0,max:s=100,value:o}){return`<div class="range color-picker__${t}" title="${t}" style="--min:${e}; --max:${s};">\n            <input type="range" name="${t}" value="${o}" min="${e}" max="${s}">\n            <output></output>\n            <div class='range__progress'></div>\n          </div>`}function l(t){return`\n    <div class='color-picker__value'>\n      <input name='value' placeholder='CSS Color' value='${n(s(t))}'>\n      <button title='Undo' name="undo">↩</button>\n      <button title='Switch color format' name='format'>⭤&nbsp;</button>\n      <div></div>\n    </div>\n  `}var h=Object.freeze({__proto__:null,scope:function(){const{h:t,s:e,l:s,a:o}=this.color;return`\n    <div class='${("color-picker "+(this.settings.className||"")).trim()}'>\n      ${r({name:"hue",value:t,max:"360"})}\n      ${r({name:"saturation",value:e})}\n      ${r({name:"lightness",value:s})}\n      ${r({name:"alpha",value:o})}\n      <output></output>\n      ${l(this.color)}\n    </div>\n  `},slider:r,value:l});function u(t){"Escape"==t.key&&this.settings.onClickOutside(t)}function c(t){this.DOM.scope.contains(t.target)||this.settings.onClickOutside(t)}function p(t){const{name:e,value:s,type:o}=t.target;"range"==o&&(this.updateCSSVar(e,s),this.setColor({...this.color,[e[0]]:+s}),t.target.parentNode.style.setProperty("--value",s),t.target.parentNode.style.setProperty("--text-value",JSON.stringify(s)))}function d(t){const{type:e}=t.target;"range"!=e&&"text"!=e||(this.history.last=this.color)}function m(t){this.setColor(this.getHSLA(t.target.value)),this.DOM.value.blur()}function g(t){const{name:e}=t.target;"format"==e?this.swithFormat():"undo"==e&&this.history.undo()}var v=Object.freeze({__proto__:null,bindEvents:function(){[["scope","input",p],["scope","change",d],["scope","click",g],["value","change",m]].forEach((([t,e,s])=>this.DOM[t].addEventListener(e,s.bind(this)))),this.settings.onClickOutside&&(document.body.addEventListener("click",c.bind(this)),window.addEventListener("keydown",u.bind(this)))}});function S(){const t=()=>this.settings.onChange(this.CSSColor),e=this.setColor.bind(this);return{_value:[this.color],get pop(){return this._value.pop()},get previous(){return this._value[this._value.length-2]},set last(e){this._value.push(e),t()},undo(){if(this._value.length>1){this.pop;let s=this._value[this._value.length-1];return e(s),t(),s}}}}function C(e){this.settings=Object.assign({},t,e),this.DOM={},this.setColor(this.getHSLA(this.settings.color)),this.history=S.call(this),this.init()}return C.prototype={templates:h,getColorFormat:t=>"#"==t[0]?"hex":t.indexOf("hsl")?t.indexOf("rgb")?"":"rgba":"hsla",getHSLA(t){let s;var a;return this.colorFormat=this.getColorFormat(t),t.indexOf("hsla")?(t=n(t),s=(t=>{let[s,i,n,a]=e(t);s/=255,i/=255,n/=255;let r=Math.max(s,i,n),l=Math.min(s,i,n),h=r-l,u=0,c=0,p=((r+l)/2).toPrecision(2);return h&&(c=p>.5?h/(2-r-l):h/(r+l),u=r==s?(i-n)/h+(i<n?6:0):u=r==i?(n-s)/h+2:(s-i)/h+4,u/=6),{h:o(360*u),s:o(100*c),l:o(100*p),a:o(100*a)}})(t=i(t))):(a=t,s=Object.assign([0,0,0,1],a.match(/\((.*)\)/)[1].split(",").map(((t,e)=>3!=e||t.includes("%")?parseFloat(t):100*parseFloat(t)))),s={h:s[0],s:s[1],l:s[2],a:s[3]}),s},swithFormat(){switch(this.colorFormat){case"":case"hex":this.colorFormat="rgba";break;case"rgba":this.colorFormat="hsla";break;case"hsla":this.colorFormat="hex"}this.setCSSColor(),this.DOM.value.value=this.CSSColor},updateRangeSlider(t,e){const s=this.DOM.scope.querySelector(`input[name="${t}"]`);s&&(s.value=e,s.parentNode.style.setProperty("--value",e),s.parentNode.style.setProperty("--text-value",JSON.stringify(""+Math.round(e))))},setCSSColor(){this.CSSColor=n(s(this.color)),"rgba"==this.colorFormat?this.CSSColor=i(this.CSSColor):"hsla"==this.colorFormat&&(this.CSSColor=s(this.color)),this.DOM.scope&&this.DOM.scope.setAttribute("data-color-format",this.colorFormat),this.settings.onInput(this.CSSColor)},setColor(t){t&&(this.color=t,this.setCSSColor(),this.DOM.scope&&this.updateAllCSSVars(),this.DOM.value&&(this.DOM.value.value=this.CSSColor))},updateCSSVar(t,e){this.DOM.scope.style.setProperty("--"+t,e)},updateAllCSSVars(){const t=this.NamedHSLA(this.color);Object.entries(t).forEach((([t,e])=>{this.updateCSSVar(t,e),this.updateRangeSlider(t,e)}))},NamedHSLA:t=>({hue:t.h,saturation:t.s,lightness:t.l,alpha:t.a}),...v,init(){const t=this.templates.scope.call(this);var e;this.DOM.scope=(e=t,(new DOMParser).parseFromString(e.trim(),"text/html").body.firstElementChild),this.DOM.value=this.DOM.scope.querySelector('input[name="value"]'),this.setColor(this.color),this.bindEvents()}},C}));
